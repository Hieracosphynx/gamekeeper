---
import { getCollection } from "astro:content";
import { ChevronLeft } from "lucide-react";

import BoardGamePluginCard from "@/components/astro/BoardGamePluginCard.astro";
import { Button } from "@/components/react/ui/button";
import { H2 } from "@/components/react/ui/typography";
import type { BoardGameCollection } from "@/content.config";
import Layout from "@/layouts/Layout.astro";

import type { GetStaticPaths } from "astro";

export const getStaticPaths = (async () => {
  const boardGames = await getCollection("boardGames");
  const pages = [
    ...boardGames.map((boardGame) => {
      return {
        ...boardGame,
      };
    }),
  ];

  return pages.map((page) => {
    return {
      params: { slug: page.data.slug },
      props: { ...page },
    };
  });
}) satisfies GetStaticPaths;

const boardGame = Astro.props as BoardGameCollection;
---

<Layout title={boardGame.data.name} ogTitle={boardGame.data.name}>
  <div class="grid grid-cols-[auto_1fr_auto] items-center">
    <a href="/">
      <Button variant="outline"><ChevronLeft /> Go Back</Button>
    </a>
    <H2 className="text-center">{boardGame.data.name}</H2>
    <div></div>
  </div>

  <div class="lg-grid-cols-4 grid grid-cols-1 gap-6 md:grid-cols-3">
    {
      boardGame.data.plugins.map((plugin) => {
        return (
          <BoardGamePluginCard
            plugin={plugin}
            boardGameSlug={boardGame.data.slug}
          />
        );
      })
    }
  </div>
</Layout>

<style>
  /* Ensure consistent card heights in grids */
  .group {
    height: 100%;
  }

  .group > div {
    height: 100%;
    display: flex;
    flex-direction: column;
  }

  .group .p-4 {
    flex: 1;
    display: flex;
    flex-direction: column;
  }

  .group .p-4 > p {
    flex: 1;
  }
</style>
